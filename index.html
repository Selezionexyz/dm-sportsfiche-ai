<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="DM Sports - Générateur professionnel de fiches produit sportswear">
    <title>DM Sports - Générateur de Fiches Produit</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --dms-black: #000000;
            --dms-white: #ffffff;
            --dms-red: #e60012;
            --dms-gray: #f5f5f5;
            --dms-border: #e0e0e0;
            --dms-text: #333333;
            --dms-success: #4CAF50;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--dms-gray);
            color: var(--dms-text);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: var(--dms-white);
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 28px;
            font-weight: 900;
            letter-spacing: -1px;
        }

        .logo-badge {
            background: var(--dms-red);
            color: var(--dms-white);
            padding: 5px 15px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .header-stats {
            display: flex;
            gap: 30px;
            font-size: 14px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--dms-red);
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        .form-panel {
            background: var(--dms-white);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
        }

        .preview-panel {
            background: var(--dms-white);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        /* Section Headers */
        .section {
            margin-bottom: 35px;
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--dms-gray);
        }

        .section-number {
            background: var(--dms-red);
            color: var(--dms-white);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            font-size: 16px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            flex: 1;
        }

        /* Form Elements */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #666;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 16px;
            border: 2px solid var(--dms-border);
            border-radius: 8px;
            font-size: 15px;
            width: 100%;
            transition: all 0.3s;
            background: var(--dms-white);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--dms-red);
            background: #fff;
            box-shadow: 0 0 0 3px rgba(230, 0, 18, 0.1);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .required {
            color: var(--dms-red);
        }

        /* Upload Box */
        .upload-box {
            border: 2px dashed var(--dms-border);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--dms-gray);
            position: relative;
            overflow: hidden;
        }

        .upload-box:hover {
            border-color: var(--dms-red);
            background: #fff5f5;
            transform: translateY(-2px);
        }

        .upload-box.has-file {
            border-color: var(--dms-success);
            background: #f1f8f4;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 10px;
            opacity: 0.7;
        }

        input[type="file"] {
            display: none;
        }

        /* Sizes and Colors */
        .sizes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .size-box {
            border: 2px solid var(--dms-border);
            padding: 12px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 600;
            background: var(--dms-white);
        }

        .size-box:hover {
            border-color: var(--dms-red);
            transform: translateY(-2px);
        }

        .size-box.selected {
            background: var(--dms-red);
            color: var(--dms-white);
            border-color: var(--dms-red);
        }

        .colors-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 15px;
        }

        .color-box {
            width: 50px;
            height: 50px;
            border: 3px solid var(--dms-border);
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
        }

        .color-box:hover {
            transform: scale(1.15);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .color-box.selected {
            border-color: var(--dms-red);
            border-width: 4px;
        }

        .color-box.selected::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 20px;
            text-shadow: 0 0 4px rgba(0,0,0,0.8);
        }

        /* Generate Button */
        .generate-btn {
            background: var(--dms-black);
            color: var(--dms-white);
            padding: 18px 40px;
            border: none;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            letter-spacing: 1px;
            margin-top: 30px;
        }

        .generate-btn:hover {
            background: var(--dms-red);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(230, 0, 18, 0.3);
        }

        .generate-btn:disabled {
            background: #999;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Preview Panel */
        .preview-header {
            background: var(--dms-black);
            color: var(--dms-white);
            padding: 20px;
            margin: -30px -30px 30px;
            border-radius: 12px 12px 0 0;
            text-align: center;
        }

        .preview-content {
            padding: 20px;
            background: #fafafa;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .preview-empty {
            text-align: center;
            padding: 60px;
            color: #999;
        }

        .preview-empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        /* Export Options */
        .export-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .export-btn {
            padding: 12px;
            border: 2px solid var(--dms-border);
            background: var(--dms-white);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            text-align: center;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .export-btn:hover {
            border-color: var(--dms-red);
            background: #fff5f5;
            transform: translateY(-2px);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dms-black);
            color: var(--dms-white);
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            font-weight: 600;
        }

        .toast.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .preview-panel {
                position: relative;
                top: auto;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .form-panel,
            .preview-panel {
                padding: 20px;
            }
            
            .header-stats {
                display: none;
            }
            
            .logo {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    DM'S SPORTS
                    <span class="logo-badge">AI PRO</span>
                </div>
                <div class="header-stats">
                    <div class="stat-item">
                        <div class="stat-value">28</div>
                        <div>Marques</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">50+</div>
                        <div>Catégories</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">∞</div>
                        <div>Fiches</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <!-- Form Panel -->
            <div class="form-panel">
                <!-- Section 1: Images -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">1</div>
                        <h2 class="section-title">Images produit</h2>
                    </div>
                    
                    <div class="upload-box" id="upload-main">
                        <input type="file" id="file-main" accept="image/*">
                        <div class="upload-icon">📸</div>
                        <div class="upload-text">
                            <strong>Image principale</strong><br>
                            <span style="font-size: 14px; color: #999;">Cliquez ou glissez une image</span>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Informations de base -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">2</div>
                        <h2 class="section-title">Informations produit</h2>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group full">
                            <label>Nom du produit <span class="required">*</span></label>
                            <input type="text" id="product-name" placeholder="Ex: Air Max 270, Survêtement Core..." required>
                        </div>
                        
                        <div class="form-group">
                            <label>Marque <span class="required">*</span></label>
                            <select id="brand" required>
                                <option value="">Sélectionner une marque</option>
                                <optgroup label="Sport Performance">
                                    <option value="nike">Nike</option>
                                    <option value="adidas">Adidas</option>
                                    <option value="puma">Puma</option>
                                    <option value="under-armour">Under Armour</option>
                                    <option value="new-balance">New Balance</option>
                                    <option value="asics">Asics</option>
                                    <option value="reebok">Reebok</option>
                                    <option value="mizuno">Mizuno</option>
                                    <option value="saucony">Saucony</option>
                                </optgroup>
                                <optgroup label="Fashion Sport">
                                    <option value="lacoste">Lacoste</option>
                                    <option value="boss">Hugo Boss</option>
                                    <option value="calvin-klein">Calvin Klein</option>
                                    <option value="armani">Emporio Armani EA7</option>
                                    <option value="polo-ralph-lauren">Polo Ralph Lauren</option>
                                    <option value="tommy-hilfiger">Tommy Hilfiger</option>
                                    <option value="gant">Gant</option>
                                    <option value="fred-perry">Fred Perry</option>
                                </optgroup>
                                <optgroup label="Streetwear">
                                    <option value="champion">Champion</option>
                                    <option value="fila">Fila</option>
                                    <option value="ellesse">Ellesse</option>
                                    <option value="kappa">Kappa</option>
                                    <option value="sergio-tacchini">Sergio Tacchini</option>
                                    <option value="vans">Vans</option>
                                    <option value="converse">Converse</option>
                                </optgroup>
                                <optgroup label="Outdoor">
                                    <option value="the-north-face">The North Face</option>
                                    <option value="columbia">Columbia</option>
                                    <option value="timberland">Timberland</option>
                                </optgroup>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Catégorie <span class="required">*</span></label>
                            <select id="category" required>
                                <option value="">Sélectionner une catégorie</option>
                                <optgroup label="CHAUSSURES">
                                    <option value="chaussures-running">Running</option>
                                    <option value="chaussures-lifestyle">Lifestyle</option>
                                    <option value="chaussures-basketball">Basketball</option>
                                    <option value="chaussures-football">Football</option>
                                    <option value="chaussures-tennis">Tennis</option>
                                    <option value="chaussures-training">Training</option>
                                </optgroup>
                                <optgroup label="VÊTEMENTS HOMME">
                                    <option value="homme-survetements">Survêtements</option>
                                    <option value="homme-sweats">Sweats</option>
                                    <option value="homme-tshirts">T-Shirts</option>
                                    <option value="homme-polos">Polos</option>
                                    <option value="homme-pantalons">Pantalons</option>
                                    <option value="homme-shorts">Shorts</option>
                                    <option value="homme-vestes">Vestes</option>
                                    <option value="homme-doudounes">Doudounes</option>
                                </optgroup>
                                <optgroup label="VÊTEMENTS FEMME">
                                    <option value="femme-survetements">Survêtements</option>
                                    <option value="femme-sweats">Sweats</option>
                                    <option value="femme-tshirts">T-Shirts</option>
                                    <option value="femme-leggings">Leggings</option>
                                    <option value="femme-brasseries">Brassières</option>
                                    <option value="femme-robes">Robes</option>
                                    <option value="femme-vestes">Vestes</option>
                                </optgroup>
                                <optgroup label="ENFANT">
                                    <option value="enfant-chaussures">Chaussures</option>
                                    <option value="enfant-survetements">Survêtements</option>
                                    <option value="enfant-sweats">Sweats</option>
                                    <option value="enfant-tshirts">T-Shirts</option>
                                </optgroup>
                                <optgroup label="ACCESSOIRES">
                                    <option value="sacs">Sacs</option>
                                    <option value="casquettes">Casquettes</option>
                                    <option value="bonnets">Bonnets</option>
                                    <option value="chaussettes">Chaussettes</option>
                                </optgroup>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Genre <span class="required">*</span></label>
                            <select id="gender" required>
                                <option value="">Sélectionner</option>
                                <option value="homme">Homme</option>
                                <option value="femme">Femme</option>
                                <option value="mixte">Mixte</option>
                                <option value="enfant">Enfant</option>
                                <option value="bebe">Bébé</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Prix (€) <span class="required">*</span></label>
                            <input type="number" id="price" placeholder="89.99" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Prix barré (€)</label>
                            <input type="number" id="old-price" placeholder="119.99" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label>Référence <span class="required">*</span></label>
                            <input type="text" id="sku" placeholder="REF-001" required>
                        </div>
                        
                        <div class="form-group">
                            <label>Code EAN</label>
                            <input type="text" id="ean" placeholder="3700000000000">
                        </div>
                    </div>
                </div>

                <!-- Section 3: Tailles et Couleurs -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">3</div>
                        <h2 class="section-title">Tailles et couleurs</h2>
                    </div>
                    
                    <label style="font-weight: 600; margin-bottom: 10px; display: block;">Tailles disponibles</label>
                    <div class="sizes-grid" id="sizes-container">
                        <!-- Généré dynamiquement -->
                    </div>

                    <label style="font-weight: 600; margin: 20px 0 10px; display: block;">Couleurs disponibles</label>
                    <div class="colors-grid">
                        <div class="color-box selected" style="background: #000000" data-color="Noir" title="Noir"></div>
                        <div class="color-box" style="background: #FFFFFF; border-color: #ddd;" data-color="Blanc" title="Blanc"></div>
                        <div class="color-box" style="background: #E5E5E5" data-color="Gris" title="Gris"></div>
                        <div class="color-box" style="background: #1E3A8A" data-color="Marine" title="Marine"></div>
                        <div class="color-box" style="background: #3B82F6" data-color="Bleu" title="Bleu"></div>
                        <div class="color-box" style="background: #EF4444" data-color="Rouge" title="Rouge"></div>
                        <div class="color-box" style="background: #10B981" data-color="Vert" title="Vert"></div>
                        <div class="color-box" style="background: #F59E0B" data-color="Orange" title="Orange"></div>
                        <div class="color-box" style="background: #EC4899" data-color="Rose" title="Rose"></div>
                        <div class="color-box" style="background: #8B5CF6" data-color="Violet" title="Violet"></div>
                        <div class="color-box" style="background: #92400E" data-color="Marron" title="Marron"></div>
                        <div class="color-box" style="background: #D4D4D8" data-color="Argent" title="Argent"></div>
                        <div class="color-box" style="background: #FCD34D" data-color="Or" title="Or"></div>
                        <div class="color-box" style="background: linear-gradient(45deg, #FF0000, #0000FF, #FFFF00)" data-color="Multicolore" title="Multicolore"></div>
                    </div>
                </div>

                <!-- Section 4: Détails produit -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">4</div>
                        <h2 class="section-title">Détails et caractéristiques</h2>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Matière principale</label>
                            <select id="material">
                                <option value="">Sélectionner</option>
                                <option value="coton">100% Coton</option>
                                <option value="polyester">Polyester</option>
                                <option value="coton-polyester">Coton/Polyester</option>
                                <option value="mesh">Mesh respirant</option>
                                <option value="cuir">Cuir</option>
                                <option value="synthetique">Synthétique</option>
                                <option value="nylon">Nylon</option>
                                <option value="laine">Laine</option>
                                <option value="elasthanne">Élasthanne</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Saison</label>
                            <select id="season">
                                <option value="">Sélectionner</option>
                                <option value="printemps-ete">Printemps/Été</option>
                                <option value="automne-hiver">Automne/Hiver</option>
                                <option value="toutes-saisons">Toutes saisons</option>
                            </select>
                        </div>
                        
                        <div class="form-group full">
                            <label>Points forts (un par ligne)</label>
                            <textarea id="features" placeholder="Technologie Dri-FIT&#10;Logo brodé&#10;Poches zippées&#10;Coupe ajustée&#10;Finitions premium"></textarea>
                        </div>
                        
                        <div class="form-group full">
                            <label>Description courte</label>
                            <textarea id="short-desc" placeholder="Décrivez brièvement le produit..."></textarea>
                        </div>
                    </div>
                </div>

                <button class="generate-btn" id="generate-btn">
                    <span>⚡</span> GÉNÉRER LA FICHE PRODUIT
                </button>
            </div>
            <!-- Preview Panel -->
            <div class="preview-panel">
                <div class="preview-header">
                    <h3>📄 Aperçu de la fiche produit</h3>
                </div>
                
                <div id="preview-empty" class="preview-empty">
                    <div class="preview-empty-icon">📝</div>
                    <p>Remplissez le formulaire et cliquez sur<br>"Générer" pour voir l'aperçu</p>
                </div>
                
                <div id="preview-content" style="display: none;">
                    <div class="preview-content">
                        <h2 id="preview-title"></h2>
                        <div id="preview-details"></div>
                        <div id="preview-description"></div>
                        <div id="preview-features"></div>
                        <div id="preview-specs"></div>
                    </div>
                    
                    <div class="export-options">
                        <button class="export-btn" onclick="exportData('copy')">
                            <span>📋</span> Copier
                        </button>
                        <button class="export-btn" onclick="exportData('html')">
                            <span>🌐</span> HTML
                        </button>
                        <button class="export-btn" onclick="exportData('json')">
                            <span>📄</span> JSON
                        </button>
                        <button class="export-btn" onclick="exportData('print')">
                            <span>🖨️</span> Imprimer
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span id="toast-message"></span>
    </div>
<script>
    // DM Sports Product Generator - JavaScript
// Copiez ce code dans une balise <script> avant la fermeture de </body>

// Configuration des tailles par catégorie
const SIZE_CONFIGS = {
    'chaussures': {
        homme: ['36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46', '47', '48'],
        femme: ['35', '36', '37', '38', '39', '40', '41', '42'],
        enfant: ['25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38'],
        bebe: ['16', '17', '18', '19', '20', '21', '22', '23', '24', '25']
    },
    'vetements': {
        homme: ['XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL', '4XL'],
        femme: ['XS', 'S', 'M', 'L', 'XL', 'XXL'],
        enfant: ['4A', '6A', '8A', '10A', '12A', '14A', '16A'],
        bebe: ['3M', '6M', '9M', '12M', '18M', '24M', '36M']
    }
};

// Upload d'image
function setupImageUpload() {
    const uploadBox = document.getElementById('upload-main');
    const fileInput = document.getElementById('file-main');

    uploadBox.addEventListener('click', () => fileInput.click());

    uploadBox.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadBox.style.borderColor = 'var(--dms-red)';
    });

    uploadBox.addEventListener('dragleave', () => {
        uploadBox.style.borderColor = 'var(--dms-border)';
    });

    uploadBox.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadBox.style.borderColor = 'var(--dms-border)';
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            handleImageFile(files[0]);
        }
    });

    fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            handleImageFile(e.target.files[0]);
        }
    });
}

function handleImageFile(file) {
    if (file.type.startsWith('image/')) {
        const uploadBox = document.getElementById('upload-main');
        uploadBox.classList.add('has-file');
        uploadBox.querySelector('strong').textContent = '✅ ' + file.name;
        
        // Créer un aperçu de l'image
        const reader = new FileReader();
        reader.onload = (e) => {
            window.uploadedImage = e.target.result;
        };
        reader.readAsDataURL(file);
    }
}

// Gestion des tailles
function updateSizes() {
    const category = document.getElementById('category').value;
    const gender = document.getElementById('gender').value;
    const container = document.getElementById('sizes-container');
    
    let sizes = [];
    
    if (category.includes('chaussures')) {
        sizes = SIZE_CONFIGS.chaussures[gender] || SIZE_CONFIGS.chaussures.homme;
    } else {
        sizes = SIZE_CONFIGS.vetements[gender] || SIZE_CONFIGS.vetements.homme;
    }
    
    container.innerHTML = sizes.map(size => 
        `<div class="size-box" data-size="${size}">${size}</div>`
    ).join('');
    
    // Ajouter les événements de clic
    document.querySelectorAll('.size-box').forEach(box => {
        box.addEventListener('click', () => {
            box.classList.toggle('selected');
        });
    });
}

// Gestion des couleurs
document.querySelectorAll('.color-box').forEach(box => {
    box.addEventListener('click', () => {
        box.classList.toggle('selected');
    });
});

// Toast notifications
function showToast(message, duration = 3000) {
    const toast = document.getElementById('toast');
    document.getElementById('toast-message').textContent = message;
    toast.classList.add('show');
    
    setTimeout(() => {
        toast.classList.remove('show');
    }, duration);
}

// Générateur de contenu produit
class ProductContentGenerator {
    constructor() {
        this.tones = {
            sport: {
                intro: ['Performance exceptionnelle', 'Conçu pour les athlètes', 'Innovation sportive'],
                descriptors: ['dynamique', 'performant', 'technique', 'innovant', 'respirant']
            },
            lifestyle: {
                intro: ['Style urbain affirmé', 'L\'alliance du confort et du style', 'Design iconique'],
                descriptors: ['tendance', 'confortable', 'polyvalent', 'moderne', 'élégant']
            },
            premium: {
                intro: ['Qualité premium', 'Excellence et raffinement', 'Luxe sportif'],
                descriptors: ['exclusif', 'haut de gamme', 'sophistiqué', 'prestigieux', 'raffiné']
            }
        };
    }

    generateDescription(data) {
        const tone = this.detectTone(data);
        const intro = this.getRandomElement(this.tones[tone].intro);
        const descriptors = this.tones[tone].descriptors;
        
        let description = `<h3>${data.name}</h3>`;
        description += `<p class="intro"><strong>${intro}</strong></p>`;
        
        // Description principale
        description += `<p>${this.generateMainDescription(data, descriptors)}</p>`;
        
        // Caractéristiques techniques
        if (data.features) {
            description += this.generateFeatures(data.features);
        }
        
        // Informations produit
        description += this.generateProductInfo(data);
        
        // Guide des tailles et entretien
        description += this.generateCareGuide(data);
        
        return description;
    }

    generateMainDescription(data, descriptors) {
        const templates = [
            `Cette ${data.category} ${data.brand} incarne le parfait équilibre entre ${descriptors[0]} et ${descriptors[1]}. 
             Conçue pour ${data.gender === 'homme' ? 'l\'homme' : data.gender === 'femme' ? 'la femme' : 'tous'} 
             ${descriptors[2]}, elle offre un confort optimal au quotidien.`,
            
            `${data.brand} présente ${data.name}, une ${data.category} ${descriptors[0]} qui redéfinit les standards. 
             Avec sa conception ${descriptors[1]} et ses finitions ${descriptors[2]}, ce modèle s'impose comme un incontournable.`,
            
            `Découvrez l'excellence avec cette ${data.category} ${data.brand}. 
             Son design ${descriptors[0]} et sa construction ${descriptors[1]} en font le choix idéal pour un style ${descriptors[2]}.`
        ];
        
        return this.getRandomElement(templates);
    }

    generateFeatures(features) {
        if (!features) return '';
        
        const featuresList = features.split('\n').filter(f => f.trim());
        if (featuresList.length === 0) return '';
        
        let html = '<div class="features-section">';
        html += '<h4>Points forts du produit :</h4>';
        html += '<ul>';
        featuresList.forEach(feature => {
            html += `<li>✓ ${feature.trim()}</li>`;
        });
        html += '</ul>';
        html += '</div>';
        
        return html;
    }

    generateProductInfo(data) {
        let html = '<div class="product-info">';
        html += '<h4>Informations produit :</h4>';
        html += '<table>';
        
        if (data.brand) html += `<tr><td><strong>Marque :</strong></td><td>${this.getBrandName(data.brand)}</td></tr>`;
        if (data.sku) html += `<tr><td><strong>Référence :</strong></td><td>${data.sku}</td></tr>`;
        if (data.ean) html += `<tr><td><strong>Code EAN :</strong></td><td>${data.ean}</td></tr>`;
        if (data.material) html += `<tr><td><strong>Composition :</strong></td><td>${this.getMaterialName(data.material)}</td></tr>`;
        if (data.season) html += `<tr><td><strong>Saison :</strong></td><td>${this.getSeasonName(data.season)}</td></tr>`;
        if (data.gender) html += `<tr><td><strong>Genre :</strong></td><td>${this.getGenderName(data.gender)}</td></tr>`;
        
        const selectedColors = Array.from(document.querySelectorAll('.color-box.selected')).map(c => c.dataset.color);
        if (selectedColors.length > 0) {
            html += `<tr><td><strong>Coloris disponibles :</strong></td><td>${selectedColors.join(', ')}</td></tr>`;
        }
        
        const selectedSizes = Array.from(document.querySelectorAll('.size-box.selected')).map(s => s.dataset.size);
        if (selectedSizes.length > 0) {
            html += `<tr><td><strong>Tailles disponibles :</strong></td><td>${selectedSizes.join(', ')}</td></tr>`;
        }
        
        html += '</table>';
        html += '</div>';
        
        return html;
    }

    generateCareGuide(data) {
        let html = '<div class="care-guide">';
        html += '<h4>Conseils d\'entretien :</h4>';
        
        const material = data.material || '';
        if (material.includes('coton') || material.includes('polyester')) {
            html += '<ul>';
            html += '<li>🌡️ Lavage en machine à 30°C</li>';
            html += '<li>🚫 Ne pas utiliser de javel</li>';
            html += '<li>♨️ Repassage à température moyenne</li>';
            html += '<li>🌀 Séchage en tambour autorisé à basse température</li>';
            html += '</ul>';
        } else if (material.includes('cuir')) {
            html += '<ul>';
            html += '<li>🧽 Nettoyer avec un chiffon humide</li>';
            html += '<li>💧 Imperméabiliser régulièrement</li>';
            html += '<li>☀️ Éviter l\'exposition prolongée au soleil</li>';
            html += '<li>👟 Utiliser des embauchoirs pour maintenir la forme</li>';
            html += '</ul>';
        } else {
            html += '<p>Suivre les instructions d\'entretien sur l\'étiquette du produit.</p>';
        }
        
        html += '</div>';
        
        // Ajout de la garantie et livraison
        html += '<div class="delivery-info">';
        html += '<h4>Livraison & Garantie :</h4>';
        html += '<ul>';
        html += '<li>📦 Livraison gratuite dès 90€ d\'achat</li>';
        html += '<li>🚚 Expédition sous 24h (jours ouvrés)</li>';
        html += '<li>🔄 Retours gratuits sous 30 jours</li>';
        html += '<li>✅ Garantie authenticité 100%</li>';
        html += '<li>💳 Paiement sécurisé CB, PayPal, Apple Pay</li>';
        html += '</ul>';
        html += '</div>';
        
        return html;
    }

    detectTone(data) {
        const category = data.category.toLowerCase();
        const brand = data.brand.toLowerCase();
        
        if (brand.includes('boss') || brand.includes('armani') || brand.includes('lacoste')) {
            return 'premium';
        } else if (category.includes('running') || category.includes('training') || category.includes('football')) {
            return 'sport';
        }
        return 'lifestyle';
    }

    getBrandName(brand) {
        const brandNames = {
            'nike': 'Nike',
            'adidas': 'Adidas',
            'puma': 'Puma',
            'lacoste': 'Lacoste',
            'boss': 'Hugo Boss',
            'calvin-klein': 'Calvin Klein',
            'armani': 'Emporio Armani EA7',
            'the-north-face': 'The North Face',
            'new-balance': 'New Balance',
            'under-armour': 'Under Armour',
            'champion': 'Champion',
            'fila': 'Fila',
            'vans': 'Vans',
            'converse': 'Converse'
        };
        return brandNames[brand] || brand;
    }

    getMaterialName(material) {
        const materials = {
            'coton': '100% Coton',
            'polyester': '100% Polyester',
            'coton-polyester': '80% Coton, 20% Polyester',
            'mesh': 'Mesh respirant haute performance',
            'cuir': 'Cuir véritable',
            'synthetique': 'Matière synthétique',
            'nylon': '100% Nylon',
            'laine': 'Laine mérinos',
            'elasthanne': '95% Coton, 5% Élasthanne'
        };
        return materials[material] || material;
    }

    getSeasonName(season) {
        const seasons = {
            'printemps-ete': 'Printemps/Été',
            'automne-hiver': 'Automne/Hiver',
            'toutes-saisons': 'Toutes saisons'
        };
        return seasons[season] || season;
    }

    getGenderName(gender) {
        const genders = {
            'homme': 'Homme',
            'femme': 'Femme',
            'mixte': 'Mixte/Unisexe',
            'enfant': 'Enfant',
            'bebe': 'Bébé'
        };
        return genders[gender] || gender;
    }

    getRandomElement(array) {
        return array[Math.floor(Math.random() * array.length)];
    }
}

// Génération de la fiche produit
async function generateProductSheet() {
    const generator = new ProductContentGenerator();
    
    // Récupération des données
    const productData = {
        name: document.getElementById('product-name').value,
        brand: document.getElementById('brand').value,
        category: document.getElementById('category').value,
        gender: document.getElementById('gender').value,
        price: document.getElementById('price').value,
        oldPrice: document.getElementById('old-price').value,
        sku: document.getElementById('sku').value,
        ean: document.getElementById('ean').value,
        material: document.getElementById('material').value,
        season: document.getElementById('season').value,
        features: document.getElementById('features').value,
        shortDesc: document.getElementById('short-desc').value
    };
    
    // Validation
    if (!productData.name || !productData.brand || !productData.category || !productData.price || !productData.sku) {
        showToast('⚠️ Veuillez remplir tous les champs obligatoires');
        return;
    }
    
    const btn = document.getElementById('generate-btn');
    btn.disabled = true;
    btn.innerHTML = '<span class="loading"></span> Génération en cours...';
    
    // Simulation du temps de génération
    await new Promise(resolve => setTimeout(resolve, 1500));
    
    // Génération du contenu
    const content = generator.generateDescription(productData);
    
    // Affichage du preview
    document.getElementById('preview-empty').style.display = 'none';
    document.getElementById('preview-content').style.display = 'block';
    
    // Mise à jour du titre
    document.getElementById('preview-title').innerHTML = `${productData.name} - ${generator.getBrandName(productData.brand)}`;
    
    // Prix
    let priceHTML = `<div class="price-section">`;
    if (productData.oldPrice && parseFloat(productData.oldPrice) > parseFloat(productData.price)) {
        const discount = Math.round((1 - productData.price / productData.oldPrice) * 100);
        priceHTML += `<span class="old-price" style="text-decoration: line-through; color: #999;">${productData.oldPrice}€</span> `;
        priceHTML += `<span class="current-price" style="font-size: 24px; font-weight: bold; color: var(--dms-red);">${productData.price}€</span> `;
        priceHTML += `<span class="discount" style="background: var(--dms-red); color: white; padding: 2px 8px; border-radius: 4px; font-size: 14px;">-${discount}%</span>`;
    } else {
        priceHTML += `<span class="current-price" style="font-size: 24px; font-weight: bold;">${productData.price}€</span>`;
    }
    priceHTML += `</div>`;
    
    document.getElementById('preview-details').innerHTML = priceHTML;
    document.getElementById('preview-description').innerHTML = content;
    
    // Réinitialiser le bouton
    btn.disabled = false;
    btn.innerHTML = '<span>⚡</span> GÉNÉRER LA FICHE PRODUIT';
    
    showToast('✅ Fiche produit générée avec succès !');
    
    // Scroll vers le preview
    document.querySelector('.preview-panel').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// Export des données
function exportData(format) {
    const title = document.getElementById('preview-title').textContent;
    const content = document.getElementById('preview-description').innerHTML;
    
    switch(format) {
        case 'copy':
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            const textContent = tempDiv.textContent || tempDiv.innerText || '';
            navigator.clipboard.writeText(`${title}\n\n${textContent}`);
            showToast('📋 Contenu copié dans le presse-papier');
            break;
            
        case 'html':
            const htmlContent = `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>${title}</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        h3 { color: #333; }
        h4 { color: #666; margin-top: 20px; }
        ul { list-style: none; padding-left: 0; }
        ul li { padding: 5px 0; }
        table { width: 100%; margin: 15px 0; }
        table td { padding: 8px; border-bottom: 1px solid #eee; }
        .price-section { margin: 20px 0; }
        .features-section, .product-info, .care-guide, .delivery-info { 
            margin: 20px 0; 
            padding: 15px; 
            background: #f9f9f9; 
            border-radius: 8px; 
        }
    </style>
</head>
<body>
    <h1>${title}</h1>
    ${document.getElementById('preview-details').innerHTML}
    ${content}
</body>
</html>`;
            
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fiche-produit-${Date.now()}.html`;
            a.click();
            showToast('📄 Fichier HTML téléchargé');
            break;
            
        case 'json':
            const jsonData = {
                title: title,
                price: document.getElementById('price').value,
                oldPrice: document.getElementById('old-price').value,
                sku: document.getElementById('sku').value,
                ean: document.getElementById('ean').value,
                brand: document.getElementById('brand').value,
                category: document.getElementById('category').value,
                description: content,
                generatedAt: new Date().toISOString()
            };
            
            navigator.clipboard.writeText(JSON.stringify(jsonData, null, 2));
            showToast('📋 JSON copié dans le presse-papier');
            break;
            
        case 'print':
            window.print();
            break;
    }
}

// Initialisation
document.addEventListener('DOMContentLoaded', function() {
    // Setup upload
    setupImageUpload();
    
    // Mise à jour des tailles quand on change de catégorie ou genre
    document.getElementById('category').addEventListener('change', updateSizes);
    document.getElementById('gender').addEventListener('change', updateSizes);
    
    // Bouton de génération
    document.getElementById('generate-btn').addEventListener('click', generateProductSheet);
    
    // Initialiser les tailles
    updateSizes();
});

// Styles pour l'impression
const printStyles = `
@media print {
    .header, .form-panel, .export-options, .toast { display: none !important; }
    .main-content { display: block !important; }
    .preview-panel { 
        position: static !important; 
        box-shadow: none !important;
        max-height: none !important;
    }
    body { background: white !important; }
}`;

const styleSheet = document.createElement('style');
styleSheet.textContent = printStyles;
document.head.appendChild(styleSheet);
</body>
</html>
