<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DM Sports - Générateur de Fiches Produit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .logo {
            font-size: 28px;
            font-weight: 900;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-badge {
            background: #e60012;
            color: white;
            padding: 5px 15px;
            border-radius: 4px;
            font-size: 14px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .form-panel {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
        }

        .preview-panel {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid #e0e0e0;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-number {
            background: #e60012;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 13px;
            text-transform: uppercase;
            color: #666;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #e60012;
            box-shadow: 0 0 0 3px rgba(230, 0, 18, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .required {
            color: #e60012;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Upload d'image */
        .upload-area {
            border: 2px dashed #e0e0e0;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
            position: relative;
            overflow: hidden;
        }

        .upload-area:hover {
            border-color: #e60012;
            background: #fff5f5;
        }

        .upload-area.has-image {
            border-color: #4CAF50;
            background: #f1f8f4;
            padding: 20px;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 10px;
            opacity: 0.5;
        }

        .upload-text {
            font-size: 14px;
            color: #666;
        }

        .upload-preview {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 8px;
            display: none;
        }

        input[type="file"] {
            display: none;
        }

        /* Tailles */
        .sizes-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .size-item {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            background: white;
        }

        .size-item:hover {
            border-color: #e60012;
            transform: translateY(-2px);
        }

        .size-item.selected {
            background: #e60012;
            color: white;
            border-color: #e60012;
        }

        /* Couleurs */
        .colors-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 10px;
        }

        .color-item {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid #e0e0e0;
            transition: all 0.3s;
            position: relative;
        }

        .color-item:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .color-item.selected {
            border-color: #e60012;
            border-width: 4px;
        }

        .color-item.selected::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 20px;
            text-shadow: 0 0 4px rgba(0,0,0,0.8);
        }

        /* Bouton Générer */
        .generate-btn {
            background: #000;
            color: white;
            padding: 18px 40px;
            border: none;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 50px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            margin-top: 30px;
        }

        .generate-btn:hover {
            background: #e60012;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(230, 0, 18, 0.3);
        }

        .generate-btn:disabled {
            background: #999;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Preview */
        .preview-header {
            background: #000;
            color: white;
            padding: 20px;
            margin: -30px -30px 30px;
            border-radius: 12px 12px 0 0;
            text-align: center;
        }

        .preview-empty {
            text-align: center;
            padding: 60px;
            color: #999;
        }

        .preview-empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .preview-content {
            display: none;
        }

        .preview-content.show {
            display: block;
        }

        .product-preview {
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .product-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 20px;
            margin-bottom: 20px;
        }

        .current-price {
            font-size: 28px;
            font-weight: bold;
            color: #e60012;
        }

        .old-price {
            text-decoration: line-through;
            color: #999;
            margin-right: 10px;
        }

        .discount-badge {
            background: #e60012;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: bold;
        }

        /* Export */
        .export-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .export-btn {
            padding: 12px;
            border: 2px solid #e0e0e0;
            background: white;
            cursor: pointer;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .export-btn:hover {
            border-color: #e60012;
            background: #fff5f5;
            transform: translateY(-2px);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #000;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            font-weight: 600;
        }

        .toast.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .preview-panel {
                position: relative;
                top: auto;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .export-options {
                grid-template-columns: 1fr;
            }
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .nav-tab {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }

        .nav-tab.active {
            background: #e60012;
            color: white;
        }

        .nav-tab:not(.active):hover {
            background: #f0f0f0;
        }

        /* Products Library */
        .products-library {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
        }

        .library-header {
            background: #e60012;
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-container {
            display: flex;
            align-items: center;
        }

        #search-bar {
            padding: 10px 15px;
            border: 2px solid transparent;
            border-radius: 25px;
            width: 300px;
            font-size: 14px;
            background: white;
            color: #333;
        }

        #search-bar:focus {
            outline: none;
            border-color: #fff;
            box-shadow: 0 0 0 2px rgba(255,255,255,0.3);
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 30px;
            min-height: 400px;
        }

        .library-empty {
            grid-column: 1 / -1;
            text-align: center;
            padding: 60px;
            color: #999;
        }

        .library-empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .product-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
            background: white;
        }

        .product-card:hover {
            border-color: #e60012;
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(230, 0, 18, 0.1);
        }

        .product-card-header {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }

        .product-card-title {
            font-weight: 700;
            font-size: 18px;
            margin-bottom: 8px;
            color: #333;
        }

        .product-card-brand {
            color: #e60012;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
        }

        .product-card-body {
            padding: 20px;
        }

        .product-card-price {
            font-size: 20px;
            font-weight: 700;
            color: #e60012;
            margin-bottom: 10px;
        }

        .product-card-meta {
            font-size: 13px;
            color: #666;
            margin-bottom: 20px;
        }

        .product-card-actions {
            display: flex;
            gap: 10px;
        }

        .card-btn {
            flex: 1;
            padding: 10px 16px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card-btn.primary {
            background: #e60012;
            color: white;
            border-color: #e60012;
        }

        .card-btn:hover {
            background: #f0f0f0;
            border-color: #e60012;
        }

        .card-btn.primary:hover {
            background: #cc0010;
            border-color: #cc0010;
        }

        .card-btn.danger {
            color: #dc3545;
            border-color: #dc3545;
        }

        .card-btn.danger:hover {
            background: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <body>
    <header class="header">
        <div class="container">
            <div class="logo">
                DM'S SPORTS
                <span class="logo-badge">AI PRO</span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Navigation améliorée -->
        <div class="nav-tabs">
            <button class="nav-tab active" id="generator-tab" onclick="switchTab('generator')">
                ⚡ Générateur
            </button>
            <button class="nav-tab" id="library-tab" onclick="switchTab('library')">
                📚 Bibliothèque (<span id="library-count">0</span>)
            </button>
        </div>

        <!-- Vue Générateur -->
        <div id="generator-view" class="main-grid">
            <!-- Panneau de formulaire -->
            <div class="form-panel">
                <!-- Section 1: Upload d'image -->
                <div class="section">
                    <h3 class="section-title">
                        <span class="section-number">1</span>
                        Image du produit
                    </h3>
                    
                    <div class="upload-area" id="upload-area">
                        <input type="file" id="file-input" accept="image/*">
                        <img class="upload-preview" id="upload-preview" alt="Aperçu">
                        <div class="upload-placeholder">
                            <div class="upload-icon">📸</div>
                            <div class="upload-text">
                                <strong>Cliquez ou glissez une image</strong><br>
                                <span style="font-size: 12px; opacity: 0.7;">JPG, PNG, WebP - Max 5MB</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Informations de base -->
                <div class="section">
                    <h3 class="section-title">
                        <span class="section-number">2</span>
                        Informations produit
                    </h3>
                    
                    <div class="form-group">
                        <label>Nom du produit <span class="required">*</span></label>
                        <input type="text" id="product-name" placeholder="Ex: Survêtement nid d'abeilles">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Marque <span class="required">*</span></label>
                            <select id="brand">
                                <option value="">Sélectionner</option>
                                <option value="Nike">Nike</option>
                                <option value="Adidas">Adidas</option>
                                <option value="Puma">Puma</option>
                                <option value="Lacoste">Lacoste</option>
                                <option value="Hugo Boss">Hugo Boss</option>
                                <option value="Calvin Klein">Calvin Klein</option>
                                <option value="Emporio Armani">Emporio Armani EA7</option>
                                <option value="Ralph Lauren">Ralph Lauren</option>
                                <option value="Tommy Hilfiger">Tommy Hilfiger</option>
                                <option value="The North Face">The North Face</option>
                                <option value="Champion">Champion</option>
                                <option value="Fila">Fila</option>
                                <option value="New Balance">New Balance</option>
                                <option value="Under Armour">Under Armour</option>
                                <option value="Asics">Asics</option>
                                <option value="Reebok">Reebok</option>
                                <option value="Vans">Vans</option>
                                <option value="Converse">Converse</option>
                                <option value="Timberland">Timberland</option>
                                <option value="Columbia">Columbia</option>
                                <option value="Ellesse">Ellesse</option>
                                <option value="Kappa">Kappa</option>
                                <option value="Sergio Tacchini">Sergio Tacchini</option>
                                <option value="Fred Perry">Fred Perry</option>
                                <option value="Gant">Gant</option>
                                <option value="Mizuno">Mizuno</option>
                                <option value="Saucony">Saucony</option>
                                <option value="Le Coq Sportif">Le Coq Sportif</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Catégorie <span class="required">*</span></label>
                            <select id="category">
                                <option value="">Sélectionner</option>
                                <optgroup label="Chaussures">
                                    <option value="chaussures-running">Running</option>
                                    <option value="chaussures-lifestyle">Lifestyle</option>
                                    <option value="chaussures-basketball">Basketball</option>
                                    <option value="chaussures-football">Football</option>
                                    <option value="chaussures-tennis">Tennis</option>
                                    <option value="chaussures-training">Training</option>
                                </optgroup>
                                <optgroup label="Vêtements">
                                    <option value="survetements">Survêtements</option>
                                    <option value="sweats">Sweats</option>
                                    <option value="tshirts">T-Shirts</option>
                                    <option value="polos">Polos</option>
                                    <option value="pantalons">Pantalons</option>
                                    <option value="shorts">Shorts</option>
                                    <option value="vestes">Vestes</option>
                                    <option value="doudounes">Doudounes</option>
                                    <option value="chemises">Chemises</option>
                                    <option value="robes">Robes</option>
                                    <option value="jupes">Jupes</option>
                                    <option value="leggings">Leggings</option>
                                </optgroup>
                                <optgroup label="Accessoires">
                                    <option value="sacs">Sacs</option>
                                    <option value="casquettes">Casquettes</option>
                                    <option value="bonnets">Bonnets</option>
                                    <option value="echarpes">Écharpes</option>
                                    <option value="gants">Gants</option>
                                    <option value="chaussettes">Chaussettes</option>
                                    <option value="ceintures">Ceintures</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Genre <span class="required">*</span></label>
                            <select id="gender">
                                <option value="">Sélectionner</option>
                                <option value="homme">Homme</option>
                                <option value="femme">Femme</option>
                                <option value="enfant">Enfant</option>
                                <option value="bebe">Bébé</option>
                                <option value="unisexe">Unisexe</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Référence <span class="required">*</span></label>
                            <input type="text" id="sku" placeholder="REF-001">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Prix (€) <span class="required">*</span></label>
                            <input type="number" id="price" placeholder="89.99" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label>Prix barré (€)</label>
                            <input type="number" id="old-price" placeholder="119.99" step="0.01">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Description courte</label>
                        <textarea id="short-desc" placeholder="Description courte du produit..."></textarea>
                    </div>
                </div>

                <!-- Section 3: Tailles et Couleurs -->
                <div class="section">
                    <h3 class="section-title">
                        <span class="section-number">3</span>
                        Tailles et couleurs
                    </h3>
                    
                    <div class="form-group">
                        <label>Tailles disponibles</label>
                        <div class="sizes-container" id="sizes-container">
                            <!-- Les tailles seront générées ici -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Couleurs disponibles</label>
                        <div class="colors-container">
                            <div class="color-item" style="background: #000000" data-color="Noir" title="Noir"></div>
                            <div class="color-item" style="background: #FFFFFF; border-color: #ccc;" data-color="Blanc" title="Blanc"></div>
                            <div class="color-item" style="background: #808080" data-color="Gris" title="Gris"></div>
                            <div class="color-item" style="background: #C0C0C0" data-color="Argent" title="Argent"></div>
                            <div class="color-item" style="background: #FFD700" data-color="Or" title="Or"></div>
                            <div class="color-item" style="background: #000080" data-color="Marine" title="Marine"></div>
                            <div class="color-item" style="background: #0000FF" data-color="Bleu" title="Bleu"></div>
                            <div class="color-item" style="background: #87CEEB" data-color="Bleu Ciel" title="Bleu Ciel"></div>
                            <div class="color-item" style="background: #FF0000" data-color="Rouge" title="Rouge"></div>
                            <div class="color-item" style="background: #8B0000" data-color="Bordeaux" title="Bordeaux"></div>
                            <div class="color-item" style="background: #FFA500" data-color="Orange" title="Orange"></div>
                            <div class="color-item" style="background: #FFFF00; border-color: #ccc;" data-color="Jaune" title="Jaune"></div>
                            <div class="color-item" style="background: #008000" data-color="Vert" title="Vert"></div>
                            <div class="color-item" style="background: #90EE90" data-color="Vert Clair" title="Vert Clair"></div>
                            <div class="color-item" style="background: #556B2F" data-color="Kaki" title="Kaki"></div>
                            <div class="color-item" style="background: #FFC0CB" data-color="Rose" title="Rose"></div>
                            <div class="color-item" style="background: #FF1493" data-color="Fuchsia" title="Fuchsia"></div>
                            <div class="color-item" style="background: #800080" data-color="Violet" title="Violet"></div>
                            <div class="color-item" style="background: #8B4513" data-color="Marron" title="Marron"></div>
                            <div class="color-item" style="background: #F5DEB3" data-color="Beige" title="Beige"></div>
                            <div class="color-item" style="background: linear-gradient(45deg, #FF0000, #0000FF, #FFFF00)" data-color="Multicolore" title="Multicolore"></div>
                        </div>
                    </div>
                </div>

                <!-- Section 4: Détails -->
                <div class="section">
                    <h3 class="section-title">
                        <span class="section-number">4</span>
                        Détails et caractéristiques
                    </h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Matière principale</label>
                            <select id="material">
                                <option value="">Sélectionner</option>
                                <option value="100% Coton">100% Coton</option>
                                <option value="Polyester">Polyester</option>
                                <option value="Coton/Polyester">Coton/Polyester</option>
                                <option value="Mesh respirant">Mesh respirant</option>
                                <option value="Cuir">Cuir</option>
                                <option value="Synthétique">Synthétique</option>
                                <option value="Nylon">Nylon</option>
                                <option value="Laine">Laine</option>
                                <option value="Élasthanne">Élasthanne</option>
                                <option value="Gore-Tex">Gore-Tex</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Saison</label>
                            <select id="season">
                                <option value="">Sélectionner</option>
                                <option value="Printemps/Été">Printemps/Été</option>
                                <option value="Automne/Hiver">Automne/Hiver</option>
                                <option value="Toutes saisons">Toutes saisons</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Points forts (un par ligne)</label>
                        <textarea id="features" placeholder="Logo brodé&#10;Poches zippées&#10;Coupe ajustée&#10;Technologie Dri-FIT"></textarea>
                    </div>
                </div>

                <button class="generate-btn" id="generate-btn">
                    <span>⚡</span> GÉNÉRER LA FICHE PRODUIT
                </button>
            </div>
            <!-- Panneau de prévisualisation -->
            <div class="preview-panel">
                <div class="preview-header">
                    <h3>📄 Aperçu de la fiche produit</h3>
                </div>
                
                <div class="preview-empty" id="preview-empty">
                    <div class="preview-empty-icon">📝</div>
                    <p>Remplissez le formulaire et cliquez sur<br>"Générer" pour voir l'aperçu</p>
                </div>
                
                <div class="preview-content" id="preview-content">
                    <div class="product-preview">
                        <h2 class="product-title" id="preview-title"></h2>
                        <div class="product-price" id="preview-price"></div>
                        <div id="preview-description"></div>
                    </div>
                    
                    <div class="export-options">
                        <button class="export-btn" onclick="copyContent()">
                            <span>📋</span> Copier
                        </button>
                        <button class="export-btn" onclick="downloadHTML()">
                            <span>🌐</span> HTML
                        </button>
                        <button class="export-btn" onclick="downloadJSON()">
                            <span>📄</span> JSON
                        </button>
                        <button class="export-btn" onclick="window.print()">
                            <span>🖨️</span> Imprimer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vue Bibliothèque -->
        <div id="library-view" style="display: none;">
            <div class="products-library">
                <div class="library-header">
                    <h2>📚 Bibliothèque des produits</h2>
                    <div class="search-container">
                        <input type="text" id="search-bar" placeholder="🔍 Rechercher un produit..." onkeyup="filterProducts()">
                    </div>
                </div>
                <div id="products-grid" class="products-grid">
                    <div class="library-empty">
                        <div class="library-empty-icon">📦</div>
                        <p>Aucun produit créé.<br>Générez votre première fiche pour commencer !</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span id="toast-message"></span>
    </div>
<script>
// Variables globales améliorées
let uploadedImage = null;
let generatedContent = {};
let savedProducts = JSON.parse(localStorage.getItem('dmSportsProducts')) || [];

// LocalStorage pour sauvegarder les produits
function saveProduct(productData) {
    const product = {
        id: Date.now().toString(),
        ...productData,
        createdAt: new Date().toISOString(),
        generatedContent: generatedContent
    };
    
    savedProducts.unshift(product); // Ajouter au début
    localStorage.setItem('dmSportsProducts', JSON.stringify(savedProducts));
    updateLibraryCount();
    
    return product;
}

function deleteProduct(productId) {
    if (!confirm('Êtes-vous sûr de vouloir supprimer ce produit ?')) return;
    
    savedProducts = savedProducts.filter(p => p.id !== productId);
    localStorage.setItem('dmSportsProducts', JSON.stringify(savedProducts));
    updateLibraryCount();
    displayProducts();
    showToast('🗑️ Produit supprimé avec succès');
}

function updateLibraryCount() {
    document.getElementById('library-count').textContent = savedProducts.length;
}

// Navigation entre onglets
function switchTab(tab) {
    const generatorView = document.getElementById('generator-view');
    const libraryView = document.getElementById('library-view');
    const generatorTab = document.getElementById('generator-tab');
    const libraryTab = document.getElementById('library-tab');
    
    if (tab === 'generator') {
        generatorView.style.display = 'grid';
        libraryView.style.display = 'none';
        generatorTab.classList.add('active');
        libraryTab.classList.remove('active');
    } else {
        generatorView.style.display = 'none';
        libraryView.style.display = 'block';
        generatorTab.classList.remove('active');
        libraryTab.classList.add('active');
        displayProducts();
    }
}

// Affichage des produits dans la bibliothèque
function displayProducts() {
    const productsGrid = document.getElementById('products-grid');
    
    if (savedProducts.length === 0) {
        productsGrid.innerHTML = `
            <div class="library-empty">
                <div class="library-empty-icon">📦</div>
                <p>Aucun produit créé.<br>Générez votre première fiche pour commencer !</p>
            </div>
        `;
        return;
    }
    
    const searchTerm = document.getElementById('search-bar').value.toLowerCase();
    const filteredProducts = savedProducts.filter(product => 
        product.name.toLowerCase().includes(searchTerm) ||
        product.brand.toLowerCase().includes(searchTerm) ||
        product.category.toLowerCase().includes(searchTerm)
    );
    
    if (filteredProducts.length === 0) {
        productsGrid.innerHTML = `
            <div class="library-empty">
                <div class="library-empty-icon">🔍</div>
                <p>Aucun produit trouvé.<br>Essayez un autre terme de recherche.</p>
            </div>
        `;
        return;
    }
    
    productsGrid.innerHTML = filteredProducts.map(product => `
        <div class="product-card">
            <div class="product-card-header">
                <div class="product-card-title">${product.name}</div>
                <div class="product-card-brand">${product.brand}</div>
            </div>
            <div class="product-card-body">
                <div class="product-card-price">${product.price}€${product.oldPrice && product.oldPrice > product.price ? ` <span style="text-decoration: line-through; color: #999; font-size: 16px;">${product.oldPrice}€</span>` : ''}</div>
                <div class="product-card-meta">
                    ${product.category.replace('-', ' ')} • ${product.gender} • ${new Date(product.createdAt).toLocaleDateString('fr-FR')}
                </div>
                <div class="product-card-actions">
                    <button class="card-btn primary" onclick="copyProductContent('${product.id}')">
                        📋 Copier
                    </button>
                    <button class="card-btn" onclick="loadProduct('${product.id}')">
                        ✏️ Modifier
                    </button>
                    <button class="card-btn danger" onclick="deleteProduct('${product.id}')">
                        🗑️ Supprimer
                    </button>
                </div>
            </div>
        </div>
    `).join('');
}

function filterProducts() {
    displayProducts();
}

function copyProductContent(productId) {
    const product = savedProducts.find(p => p.id === productId);
    if (!product) return;
    
    const content = product.generatedContent.description.replace(/<[^>]*>/g, '');
    const title = product.generatedContent.title;
    const price = `${product.price}€${product.oldPrice && product.oldPrice > product.price ? ` (était ${product.oldPrice}€)` : ''}`;
    
    const fullContent = `${title}\n${price}\n\n${content}`;
    
    navigator.clipboard.writeText(fullContent).then(() => {
        showToast('📋 Contenu copié dans le presse-papier');
    });
}

function loadProduct(productId) {
    const product = savedProducts.find(p => p.id === productId);
    if (!product) return;
    
    // Remplir le formulaire avec les données du produit
    document.getElementById('product-name').value = product.name;
    document.getElementById('brand').value = product.brand;
    document.getElementById('category').value = product.category;
    document.getElementById('gender').value = product.gender;
    document.getElementById('price').value = product.price;
    document.getElementById('old-price').value = product.oldPrice || '';
    document.getElementById('sku').value = product.sku;
    document.getElementById('short-desc').value = product.shortDesc || '';
    document.getElementById('material').value = product.material || '';
    document.getElementById('season').value = product.season || '';
    document.getElementById('features').value = product.features ? product.features.join('\n') : '';
    
    // Mettre à jour les tailles et couleurs
    updateSizes();
    
    setTimeout(() => {
        // Sélectionner les tailles sauvegardées
        if (product.sizes) {
            product.sizes.forEach(size => {
                const sizeElement = document.querySelector(`.size-item[data-size="${size}"]`);
                if (sizeElement) sizeElement.classList.add('selected');
            });
        }
        
        // Sélectionner les couleurs sauvegardées
        if (product.colors) {
            product.colors.forEach(color => {
                const colorElement = document.querySelector(`.color-item[data-color="${color}"]`);
                if (colorElement) colorElement.classList.add('selected');
            });
        }
    }, 100);
    
    // Revenir au générateur
    switchTab('generator');
    showToast('📝 Produit chargé pour modification');
}

// Gestion de l'upload d'image améliorée
function setupImageUpload() {
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-input');
    const preview = document.getElementById('upload-preview');
    const placeholder = document.querySelector('.upload-placeholder');

    // Clic sur la zone
    uploadArea.addEventListener('click', () => fileInput.click());

    // Drag & Drop amélioré
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#e60012';
        uploadArea.style.background = '#fff5f5';
    });

    uploadArea.addEventListener('dragleave', () => {
        uploadArea.style.borderColor = '#e0e0e0';
        uploadArea.style.background = '#fafafa';
    });

    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.style.borderColor = '#e0e0e0';
        uploadArea.style.background = '#fafafa';
        
        const files = e.dataTransfer.files;
        if (files.length > 0 && files[0].type.startsWith('image/')) {
            handleImageFile(files[0]);
        } else {
            showToast('❌ Veuillez sélectionner une image valide');
        }
    });

    // Selection de fichier
    fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            handleImageFile(e.target.files[0]);
        }
    });
}

function handleImageFile(file) {
    // Vérifier la taille (max 5MB)
    if (file.size > 5 * 1024 * 1024) {
        showToast('❌ L\'image ne doit pas dépasser 5MB');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = (e) => {
        uploadedImage = e.target.result;
        const preview = document.getElementById('upload-preview');
        const placeholder = document.querySelector('.upload-placeholder');
        const uploadArea = document.getElementById('upload-area');
        
        preview.src = uploadedImage;
        preview.style.display = 'block';
        placeholder.style.display = 'none';
        uploadArea.classList.add('has-image');
        
        showToast('✅ Image ajoutée avec succès');
    };
    reader.readAsDataURL(file);
}

// Gestion des tailles
function updateSizes() {
    const category = document.getElementById('category').value;
    const gender = document.getElementById('gender').value;
    const container = document.getElementById('sizes-container');
    
    let sizes = [];
    
    // Déterminer les tailles selon la catégorie et le genre
    if (category.includes('chaussures')) {
        if (gender === 'homme') {
            sizes = ['39', '40', '41', '42', '43', '44', '45', '46', '47', '48'];
        } else if (gender === 'femme') {
            sizes = ['35', '36', '37', '38', '39', '40', '41', '42'];
        } else if (gender === 'enfant') {
            sizes = ['28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38'];
        } else if (gender === 'bebe') {
            sizes = ['16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27'];
        } else {
            sizes = ['36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46'];
        }
    } else {
        // Vêtements
        if (gender === 'enfant') {
            sizes = ['4A', '6A', '8A', '10A', '12A', '14A', '16A'];
        } else if (gender === 'bebe') {
            sizes = ['3M', '6M', '9M', '12M', '18M', '24M', '36M'];
        } else {
            sizes = ['XXS', 'XS', 'S', 'M', 'L', 'XL', 'XXL', '3XL'];
        }
    }
    
    // Générer les boutons de taille
    container.innerHTML = sizes.map(size => 
        `<div class="size-item" data-size="${size}">${size}</div>`
    ).join('');
    
    // Ajouter les événements de clic
    setupSizeSelection();
}

function setupSizeSelection() {
    document.querySelectorAll('.size-item').forEach(item => {
        item.addEventListener('click', function() {
            this.classList.toggle('selected');
        });
    });
}

// Gestion des couleurs
function setupColorSelection() {
    document.querySelectorAll('.color-item').forEach(item => {
        item.addEventListener('click', function() {
            this.classList.toggle('selected');
        });
    });
}

// Toast notifications
function showToast(message, duration = 3000) {
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toast-message');
    
    toastMessage.textContent = message;
    toast.classList.add('show');
    
    setTimeout(() => {
        toast.classList.remove('show');
    }, duration);
}

// Générateur de contenu
function generateProductContent() {
    const productName = document.getElementById('product-name').value;
    const brand = document.getElementById('brand').value;
    const category = document.getElementById('category').value;
    const gender = document.getElementById('gender').value;
    const price = document.getElementById('price').value;
    const oldPrice = document.getElementById('old-price').value;
    const material = document.getElementById('material').value;
    const season = document.getElementById('season').value;
    const features = document.getElementById('features').value;
    const shortDesc = document.getElementById('short-desc').value;
    
    // Validation
    if (!productName || !brand || !category || !gender || !price) {
        showToast('⚠️ Veuillez remplir tous les champs obligatoires');
        return false;
    }
    
    // Génération du contenu
    let content = {
        title: `${productName} - ${brand}`,
        price: price,
        oldPrice: oldPrice,
        description: ''
    };
    
    // Description principale
    let description = '<div class="product-description">';
    
    // Introduction
    description += `<p><strong>${generateIntro(brand, category, gender)}</strong></p>`;
    
    // Description détaillée
    description += `<p>${generateDetailedDescription(productName, brand, category, gender, material, shortDesc)}</p>`;
    
    // Caractéristiques
    if (features) {
        description += '<h4>✨ Points forts du produit</h4>';
        description += '<ul>';
        features.split('\n').forEach(feature => {
            if (feature.trim()) {
                description += `<li>• ${feature.trim()}</li>`;
            }
        });
        description += '</ul>';
    }
    
    // Informations techniques
    description += '<h4>📋 Informations techniques</h4>';
    description += '<table style="width: 100%; margin: 15px 0;">';
    description += `<tr><td><strong>Marque :</strong></td><td>${brand}</td></tr>`;
    description += `<tr><td><strong>Référence :</strong></td><td>${document.getElementById('sku').value}</td></tr>`;
    description += `<tr><td><strong>Genre :</strong></td><td>${gender.charAt(0).toUpperCase() + gender.slice(1)}</td></tr>`;
    
    if (material) {
        description += `<tr><td><strong>Composition :</strong></td><td>${material}</td></tr>`;
    }
    
    if (season) {
        description += `<tr><td><strong>Saison :</strong></td><td>${season}</td></tr>`;
    }
    
    // Tailles sélectionnées
    const selectedSizes = Array.from(document.querySelectorAll('.size-item.selected')).map(s => s.dataset.size);
    if (selectedSizes.length > 0) {
        description += `<tr><td><strong>Tailles disponibles :</strong></td><td>${selectedSizes.join(', ')}</td></tr>`;
    }
    
    // Couleurs sélectionnées
    const selectedColors = Array.from(document.querySelectorAll('.color-item.selected')).map(c => c.dataset.color);
    if (selectedColors.length > 0) {
        description += `<tr><td><strong>Coloris disponibles :</strong></td><td>${selectedColors.join(', ')}</td></tr>`;
    }
    
    description += '</table>';
    
    // Guide d'entretien
    description += generateCareGuide(material, category);
    
    // Livraison et garanties
    description += '<h4>🚚 Livraison & Services</h4>';
    description += '<ul>';
    description += '<li>✅ Livraison gratuite dès 90€ d\'achat</li>';
    description += '<li>📦 Expédition sous 24h (jours ouvrés)</li>';
    description += '<li>🔄 Retours gratuits sous 30 jours</li>';
    description += '<li>💯 Garantie authenticité 100%</li>';
    description += '<li>💳 Paiement sécurisé (CB, PayPal, Apple Pay)</li>';
    description += '</ul>';
    
    description += '</div>';
    
    content.description = description;
    generatedContent = content;
    
    return true;
}

function generateIntro(brand, category, gender) {
    const intros = {
        'Nike': 'Performance et innovation au service du sport',
        'Adidas': 'L\'excellence sportive depuis 1949',
        'Lacoste': 'L\'élégance sportive à la française',
        'Hugo Boss': 'Le luxe et la sophistication',
        'The North Face': 'L\'aventure sans limites',
        'Puma': 'Forever Faster - La vitesse au service du style'
    };
    
    return intros[brand] || 'Qualité et style garantis';
}

function generateDetailedDescription(name, brand, category, gender, material, shortDesc) {
    let desc = shortDesc || '';
    
    if (!desc) {
        // Génération automatique si pas de description
        const templates = [
            `Ce ${category} ${brand} incarne le parfait équilibre entre style et performance. Conçu pour ${gender === 'homme' ? 'l\'homme moderne' : gender === 'femme' ? 'la femme active' : 'tous'}, il offre un confort optimal au quotidien.`,
            `Découvrez l'excellence avec ce ${category} ${brand}. Sa conception soignée et ses finitions de qualité en font un choix idéal pour toutes vos activités.`,
            `${brand} présente ${name}, un ${category} qui allie technicité et esthétisme. Un must-have pour votre garde-robe.`
        ];
        
        desc = templates[Math.floor(Math.random() * templates.length)];
    }
    
    // Ajouter des détails selon la catégorie
    if (category.includes('chaussures')) {
        desc += ' La semelle offre un amorti exceptionnel et une adhérence optimale sur toutes les surfaces.';
    } else if (category.includes('survetement')) {
        desc += ' Sa coupe moderne et ses détails techniques en font le compagnon idéal pour vos séances de sport comme pour vos moments de détente.';
    }
    
    return desc;
}

function generateCareGuide(material, category) {
    let guide = '<h4>🧺 Conseils d\'entretien</h4>';
    guide += '<ul>';
    
    if (category.includes('chaussures')) {
        guide += '<li>🧽 Nettoyer avec un chiffon humide</li>';
        guide += '<li>💧 Imperméabiliser régulièrement</li>';
        guide += '<li>☀️ Éviter l\'exposition prolongée au soleil</li>';
        guide += '<li>👟 Utiliser des embauchoirs pour maintenir la forme</li>';
    } else if (material && (material.includes('Coton') || material.includes('Polyester'))) {
        guide += '<li>🌡️ Lavage en machine à 30°C</li>';
        guide += '<li>🚫 Ne pas utiliser de javel</li>';
        guide += '<li>♨️ Repassage à température moyenne</li>';
        guide += '<li>🌀 Séchage en tambour autorisé à basse température</li>';
    } else {
        guide += '<li>📖 Suivre les instructions sur l\'étiquette</li>';
        guide += '<li>🌡️ Lavage à température modérée recommandé</li>';
        guide += '<li>🚫 Éviter le sèche-linge si possible</li>';
    }
    
    guide += '</ul>';
    return guide;
}

// Affichage du contenu généré
function displayGeneratedContent() {
    const previewEmpty = document.getElementById('preview-empty');
    const previewContent = document.getElementById('preview-content');
    const previewTitle = document.getElementById('preview-title');
    const previewPrice = document.getElementById('preview-price');
    const previewDescription = document.getElementById('preview-description');
    
    // Masquer le placeholder
    previewEmpty.style.display = 'none';
    previewContent.classList.add('show');
    
    // Titre
    previewTitle.textContent = generatedContent.title;
    
    // Prix
    let priceHTML = '';
    if (generatedContent.oldPrice && parseFloat(generatedContent.oldPrice) > parseFloat(generatedContent.price)) {
        const discount = Math.round((1 - generatedContent.price / generatedContent.oldPrice) * 100);
        priceHTML = `
            <span class="old-price">${generatedContent.oldPrice}€</span>
            <span class="current-price">${generatedContent.price}€</span>
            <span class="discount-badge">-${discount}%</span>
        `;
    } else {
        priceHTML = `<span class="current-price">${generatedContent.price}€</span>`;
    }
    previewPrice.innerHTML = priceHTML;
    
    // Description
    previewDescription.innerHTML = generatedContent.description;
}

// Bouton de génération
async function handleGenerate() {
    const btn = document.getElementById('generate-btn');
    
    // Désactiver le bouton
    btn.disabled = true;
    btn.innerHTML = '<span class="loading"></span> Génération en cours...';
    
    // Générer le contenu
    if (generateProductContent()) {
        // Simuler un délai
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        // Afficher le résultat
        displayGeneratedContent();
        
        showToast('✅ Fiche produit générée avec succès !');
        
        // Scroll vers le preview
        document.querySelector('.preview-panel').scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
        });
    }
    
    // Réactiver le bouton
    btn.disabled = false;
    btn.innerHTML = '<span>⚡</span> GÉNÉRER LA FICHE PRODUIT';
}

// Fonctions d'export
function copyContent() {
    const content = document.getElementById('preview-description').innerText;
    const title = document.getElementById('preview-title').textContent;
    const price = document.getElementById('preview-price').textContent;
    
    const fullContent = `${title}\n${price}\n\n${content}`;
    
    navigator.clipboard.writeText(fullContent).then(() => {
        showToast('📋 Contenu copié dans le presse-papier');
    });
}

function downloadHTML() {
    const title = generatedContent.title;
    const content = generatedContent.description;
    const price = document.getElementById('preview-price').innerHTML;
    
    const html = `
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title} - DM Sports</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 { color: #333; }
        h4 { color: #666; margin-top: 25px; }
        .price { font-size: 24px; margin: 20px 0; }
        .old-price { text-decoration: line-through; color: #999; }
        .current-price { font-weight: bold; color: #e60012; }
        .discount-badge { 
            background: #e60012; 
            color: white; 
            padding: 4px 12px; 
            border-radius: 4px; 
            font-size: 14px; 
        }
        ul { list-style: none; padding-left: 0; }
        ul li { padding: 5px 0; }
        table { width: 100%; margin: 15px 0; border-collapse: collapse; }
        table td { padding: 8px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>
    <h1>${title}</h1>
    <div class="price">${price}</div>
    ${content}
    <hr style="margin-top: 40px;">
    <p style="text-align: center; color: #666;">
        Généré par DM Sports AI Pro - ${new Date().toLocaleDateString('fr-FR')}
    </p>
</body>
</html>`;
    
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `fiche-produit-${Date.now()}.html`;
    a.click();
    URL.revokeObjectURL(url);
    
    showToast('📄 Fichier HTML téléchargé');
}

function downloadJSON() {
    const data = {
        title: generatedContent.title,
        brand: document.getElementById('brand').value,
        category: document.getElementById('category').value,
        gender: document.getElementById('gender').value,
        price: generatedContent.price,
        oldPrice: generatedContent.oldPrice,
        sku: document.getElementById('sku').value,
        material: document.getElementById('material').value,
        season: document.getElementById('season').value,
        sizes: Array.from(document.querySelectorAll('.size-item.selected')).map(s => s.dataset.size),
        colors: Array.from(document.querySelectorAll('.color-item.selected')).map(c => c.dataset.color),
        description: document.getElementById('preview-description').innerText,
        generatedAt: new Date().toISOString()
    };
    
    const json = JSON.stringify(data, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `fiche-produit-${Date.now()}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    showToast('📋 Fichier JSON téléchargé');
}

// Initialisation
document.addEventListener('DOMContentLoaded', function() {
    // Setup des fonctionnalités
    setupImageUpload();
    setupColorSelection();
    
    // Événements
    document.getElementById('category').addEventListener('change', updateSizes);
    document.getElementById('gender').addEventListener('change', updateSizes);
    document.getElementById('generate-btn').addEventListener('click', handleGenerate);
    
    // Initialiser les tailles
    updateSizes();
});

// Styles d'impression
const printStyles = document.createElement('style');
printStyles.textContent = `
@media print {
    .header, .form-panel, .export-options, .toast, .preview-header, .preview-empty { 
        display: none !important; 
    }
    .main-grid { 
        display: block !important; 
    }
    .preview-panel { 
        position: static !important; 
        box-shadow: none !important;
        padding: 0 !important;
        background: white !important;
    }
    body { 
        background: white !important; 
    }
}`;
document.head.appendChild(printStyles);
</body>
</html>
